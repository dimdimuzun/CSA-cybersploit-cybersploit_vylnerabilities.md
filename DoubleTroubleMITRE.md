#  MITRE ATT&CK Mapping ‚Äî CTF *DoubleTrouble*

---

##  Phase 1 ‚Äî Reconnaissance / Discovery

### üîπ –í–∏—è–≤–ª–µ–Ω–Ω—è —Ö–æ—Å—Ç—ñ–≤ —É –º–µ—Ä–µ–∂—ñ

**–î—ñ—è:**

```bash
netdiscover -r 10.0.2.0/24
```

| MITRE –¢–∞–∫—Ç–∏–∫–∞ | –¢–µ—Ö–Ω—ñ–∫–∞                   | ID    |
| ------------- | ------------------------- | ----- |
| Discovery     | Network Service Discovery | T1046 |

### –í–∏—è–≤–ª–µ–Ω–Ω—è –∞–∫—Ç–∏–≤–Ω–∏—Ö –≤—É–∑–ª—ñ–≤ —É –ª–æ–∫–∞–ª—å–Ω—ñ–π –º–µ—Ä–µ–∂—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é ARP-—Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è.

---

### üîπ –°–∫–∞–Ω—É–≤–∞–Ω–Ω—è –ø–æ—Ä—Ç—ñ–≤ —Ç–∞ —Å–µ—Ä–≤—ñ—Å—ñ–≤

**–î—ñ—è:**

```bash
nmap -A -sV 10.0.2.14
```

| MITRE –¢–∞–∫—Ç–∏–∫–∞ | –¢–µ—Ö–Ω—ñ–∫–∞                  | ID    |
| ------------- | ------------------------ | ----- |
| Discovery     | Network Service Scanning | T1046 |

### –í–∏—è–≤–ª–µ–Ω–Ω—è –≤—ñ–¥–∫—Ä–∏—Ç–∏—Ö –ø–æ—Ä—Ç—ñ–≤, —Å–µ—Ä–≤—ñ—Å—ñ–≤, –≤–µ—Ä—Å—ñ–π –ü–ó.

---

### üîπ –ü–µ—Ä–µ–ª—ñ–∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ–π –≤–µ–±—Å–µ—Ä–≤–µ—Ä–∞

**–î—ñ—è:**

```bash
gobuster dir ...
dirb http://10.0.2.16
```

| MITRE –¢–∞–∫—Ç–∏–∫–∞ | –¢–µ—Ö–Ω—ñ–∫–∞                      | ID    |
| ------------- | ---------------------------- | ----- |
| Discovery     | File and Directory Discovery | T1083 |

### –í–∏—è–≤–ª–µ–Ω–Ω—è –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏—Ö –∫–∞—Ç–∞–ª–æ–≥—ñ–≤ —Ç–∞ —Ä–µ—Å—É—Ä—Å—ñ–≤.

---

---

##  Phase 2 ‚Äî Initial Access

### üîπ –û—Ç—Ä–∏–º–∞–Ω–Ω—è –æ–±–ª—ñ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö —á–µ—Ä–µ–∑ —Å—Ç–µ–≥–∞–Ω–æ–≥—Ä–∞—Ñ—ñ—é

**–î—ñ—è:**

```bash
stegcracker doubletrouble.jpg
```

| MITRE –¢–∞–∫—Ç–∏–∫–∞     | –¢–µ—Ö–Ω—ñ–∫–∞               | ID    |
| ----------------- | --------------------- | ----- |
| Credential Access | Unsecured Credentials | T1552 |

### –û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è –∑ –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏—Ö –¥–∞–Ω–∏—Ö —É —Ñ–∞–π–ª—ñ.

---

### üîπ SQL Injection –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö

**–î—ñ—è:**

```bash
sqlmap -r sql --dump
```

| MITRE –¢–∞–∫—Ç–∏–∫–∞     | –¢–µ—Ö–Ω—ñ–∫–∞                           | ID    |
| ----------------- | --------------------------------- | ----- |
| Initial Access    | Exploit Public-Facing Application | T1190 |
| Credential Access | Credentials from Web Application  | T1555 |

### –ï–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è SQL-—ñ–Ω º—î–∫—Ü—ñ—ó –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –ª–æ–≥—ñ–Ω—ñ–≤ —ñ –ø–∞—Ä–æ–ª—ñ–≤.

---

### üîπ –í—Ö—ñ–¥ –ø–æ SSH –∑ –≤–∏–∫—Ä–∞–¥–µ–Ω–∏–º–∏ –æ–±–ª—ñ–∫–æ–≤–∏–º–∏ –¥–∞–Ω–∏–º–∏

**–î—ñ—è:**

```bash
ssh clapton@host
```

| MITRE –¢–∞–∫—Ç–∏–∫–∞    | –¢–µ—Ö–Ω—ñ–∫–∞               | ID        |
| ---------------- | --------------------- | --------- |
| Lateral Movement | Remote Services (SSH) | T1021.004 |

### –î–æ—Å—Ç—É–ø –¥–æ —Å–∏—Å—Ç–µ–º–∏ —á–µ—Ä–µ–∑ –ª–µ–≥—ñ—Ç–∏–º–Ω–∏–π —Å–µ—Ä–≤—ñ—Å.

---

---

##  Phase 3 ‚Äî Execution / Persistence

### üîπ –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ä–µ–≤–µ—Ä—Å-—à–µ–ª–ª—É

**–î—ñ—è:**

* –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è PHP reverse shell
* –í–∏–∫–æ–Ω–∞–Ω–Ω—è —á–µ—Ä–µ–∑ —É—Ä–∞–∑–ª–∏–≤–∏–π qdPM

| MITRE –¢–∞–∫—Ç–∏–∫–∞ | –¢–µ—Ö–Ω—ñ–∫–∞                                 | ID        |
| ------------- | --------------------------------------- | --------- |
| Execution     | Command and Scripting Interpreter (PHP) | T1059.004 |
| Persistence   | Web Shell                               | T1505.003 |

### –†–æ–∑–º—ñ—â–µ–Ω–Ω—è –±–µ–∫–¥–æ—Ä—É –Ω–∞ –≤–µ–±—Å–µ—Ä–≤–µ—Ä—ñ.

---

---

##  Phase 4 ‚Äî Privilege Escalation

### üîπ Escalation —á–µ—Ä–µ–∑ sudo + awk

**–î—ñ—è:**

```bash
sudo awk 'BEGIN { system("/bin/bash") }'
```

| MITRE –¢–∞–∫—Ç–∏–∫–∞        | –¢–µ—Ö–Ω—ñ–∫–∞                           | ID    |
| -------------------- | --------------------------------- | ----- |
| Privilege Escalation | Abuse Elevation Control Mechanism | T1548 |
| Execution            | Command and Scripting Interpreter | T1059 |

### –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è sudo –¥–æ–∑–≤–æ–ª—è—î –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω—ñ –∫–æ–º–∞–Ω–¥–∏ –∑ root-–ø—Ä–∞–≤–∞–º–∏.

---

### üîπ Escalation —á–µ—Ä–µ–∑ Dirty COW

**–î—ñ—è:**

```bash
gcc exploit.c
./dirty
```

| MITRE –¢–∞–∫—Ç–∏–∫–∞        | –¢–µ—Ö–Ω—ñ–∫–∞                               | ID    |
| -------------------- | ------------------------------------- | ----- |
| Privilege Escalation | Exploitation for Privilege Escalation | T1068 |

### –ï–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è —É—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ —è–¥—Ä–∞ Linux.

---

---

##  Phase 5 ‚Äî Credential Access

### üîπ Dump –æ–±–ª—ñ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö –∑ –±–∞–∑–∏

**–î—ñ—è:** SQLMap dump

| MITRE –¢–∞–∫—Ç–∏–∫–∞     | –¢–µ—Ö–Ω—ñ–∫–∞                          | ID    |
| ----------------- | -------------------------------- | ----- |
| Credential Access | Credentials from Password Stores | T1555 |

---

---

##  Phase 6 ‚Äî Collection

### üîπ –ü–æ—à—É–∫ —Ñ–ª–∞–≥—ñ–≤

**–î—ñ—è:**

```bash
cat user.txt
cat root.txt
```

| MITRE –¢–∞–∫—Ç–∏–∫–∞ | –¢–µ—Ö–Ω—ñ–∫–∞                | ID    |
| ------------- | ---------------------- | ----- |
| Collection    | Data from Local System | T1005 |

### –û—Ç—Ä–∏–º–∞–Ω–Ω—è —Ü—ñ–ª—å–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö.

---

---

#  –ó–≤–µ–¥–µ–Ω–∞ —Ç–∞–±–ª–∏—Ü—è (–∫–æ—Ä–æ—Ç–∫–∞)

| –ö—Ä–æ–∫                  | –î—ñ—è                | MITRE ID              |
| --------------------- | ------------------ | --------------------- |
| Network scan          | netdiscover / nmap | T1046                 |
| Directory brute-force | gobuster / dirb    | T1083                 |
| Steganography creds   | stegcracker        | T1552                 |
| SQL Injection         | sqlmap             | T1190                 |
| Dump credentials      | sqlmap             | T1555                 |
| SSH access            | ssh                | T1021.004             |
| Reverse shell         | PHP shell          | T1059.004 / T1505.003 |
| Sudo misconfig        | awk                | T1548                 |
| Kernel exploit        | Dirty COW          | T1068                 |
| Flag collection       | cat                | T1005                 |

---